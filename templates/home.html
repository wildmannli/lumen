{{ define "home.html" }}
{{ template "meta_head" . }}
{{ template "header" . }}

<div class="grid grid-cols-1 lg:grid-cols-12 gap-12 h-full">

    <!-- Create Form -->
    <div class="lg:col-span-8 flex flex-col gap-6">
        <div class="flex flex-col items-start gap-1 sm:flex-row sm:items-end sm:gap-0 justify-between border-b border-neutral-700 pb-4 mb-2">
            <h1 class="text-2xl font-bold text-white tracking-tight">New Paste</h1>
            <span class="text-[11px] sm:text-xs font-mono text-neutral-500 uppercase">Secure • Encrypted • Ephemeral</span>
        </div>

        {{ if .Error }}
        <div
            class="bg-red-950/30 border border-red-900/50 text-red-200 px-4 py-3 rounded text-sm flex items-center gap-3">
            <span class="text-red-500 font-bold">!</span> {{ .Error }}
        </div>
        {{ end }}

        <form method="POST" action="/" class="flex flex-col gap-6 h-full">
            <input type="hidden" name="_csrf_token" value="{{ .CSRFToken }}">
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div class="space-y-1.5">
                    <label for="title" class="text-xs font-semibold text-neutral-500 uppercase tracking-wider">Title /
                        File Name</label>
                    <input type="text" id="title" name="title"
                        maxlength="200"
                        class="input-minimal w-full px-4 py-3 rounded text-sm placeholder-neutral-600 font-medium"
                        placeholder="e.g. database_schema.sql"
                        value="{{ with .ForkTitle }}{{ . }}{{ end }}">
                </div>

                <div class="space-y-1.5">
                    <label for="visibility"
                        class="text-xs font-semibold text-neutral-500 uppercase tracking-wider">Visibility</label>
                    <div class="relative">
                        <select id="visibility" name="visibility"
                            required
                            class="input-minimal w-full px-4 py-3 rounded text-sm appearance-none cursor-pointer">
                            <option value="unlisted">Unlisted (Link Only)</option>
                            <option value="public">Public (Listed in Feed)</option>
                        </select>
                        <div class="absolute right-4 top-1/2 -translate-y-1/2 pointer-events-none text-neutral-600">
                            <img src="/static/icons/chevron-down.png" alt="v" class="w-2.5 h-1.5 opacity-60 invert">
                        </div>
                    </div>
                </div>
            </div>

            <div class="flex flex-col space-y-1.5 min-h-[400px]">
                <div class="flex justify-between items-center">
                    <label for="content" class="text-xs font-semibold text-neutral-500 uppercase tracking-wider">Content
                        <span class="text-neutral-700">(Markdown Supported)</span></label>
                </div>
                <textarea id="content" name="content" required
                    minlength="1"
                    maxlength="524288"
                    class="w-full h-full min-h-[400px] p-4 bg-[#111] border border-neutral-700 rounded font-mono text-sm leading-relaxed text-neutral-300 focus:border-white focus:outline-none focus:ring-0 placeholder-neutral-600 resize-none custom-scrollbar transition-colors"
                    placeholder="// Paste your code or text here...">{{ with .ForkContent }}{{ . }}{{ end }}</textarea>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 pt-4 border-t border-neutral-800">
                <div class="space-y-1.5">
                    <label for="expires_in"
                        class="text-xs font-semibold text-neutral-500 uppercase tracking-wider">Expiration</label>
                    <div class="relative">
                        <select id="expires_in" name="expires_in"
                            required
                            class="input-minimal w-full px-3 py-2.5 rounded text-sm appearance-none">
                            {{ range .ExpirationOptions }}
                            <option value="{{ .Value }}" {{ if eq .Value "24h" }}selected{{ end }}>{{ .Label }}</option>
                            {{ end }}
                        </select>
                        <div class="absolute right-3 top-1/2 -translate-y-1/2 pointer-events-none text-neutral-600">
                            <img src="/static/icons/chevron-down.png" alt="v" class="w-2.5 h-1.5 opacity-60 invert">
                        </div>
                    </div>
                </div>

                <div class="space-y-1.5">
                    <label for="password"
                        class="text-xs font-semibold text-neutral-500 uppercase tracking-wider">Password
                        Protection</label>
                    <input type="password" id="password" name="password"
                        minlength="8"
                        maxlength="128"
                        autocomplete="new-password"
                        class="input-minimal w-full px-3 py-2.5 rounded text-sm placeholder-neutral-600"
                        placeholder="Optional (min 8 characters)">
                </div>

                <div class="flex items-end">
                    <button type="submit"
                        class="w-full py-2.5 px-6 bg-white text-black font-semibold rounded-md text-sm hover:bg-neutral-200 transition-colors flex items-center justify-center gap-2">
                        <span>Create Paste</span>
                        <img src="/static/icons/arrow-right.png" alt="->" class="w-4 h-4 opacity-80 invert-0">
                    </button>
                </div>
            </div>

            <div class="flex items-center gap-2">
                <input type="checkbox" id="burn_after_reading" name="burn_after_reading"
                    class="w-4 h-4 bg-black border border-neutral-700 rounded text-black focus:ring-0 focus:ring-offset-0 cursor-pointer appearance-none checked:bg-white checked:border-white transition-colors relative after:content-[''] after:hidden after:absolute after:left-1/2 after:top-1/2 after:-translate-x-1/2 after:-translate-y-1/2 after:w-2 after:h-2 after:bg-black after:rounded-sm checked:after:block">
                <label for="burn_after_reading"
                    class="text-xs text-neutral-400 cursor-pointer select-none hover:text-white transition-colors">
                    Burn After Reading (Self Destruct)
                </label>
            </div>
        </form>
    </div>

    <!-- Public Feed -->
    <div class="lg:col-span-4 border-l border-neutral-800 lg:pl-12 flex flex-col gap-6 mt-12 lg:mt-0">
        <div class="flex items-end justify-between border-b border-neutral-700 pb-4 mb-2">
            <h2 class="text-lg font-bold text-white tracking-tight">Public Feed</h2>
        </div>

        {{ if .PublicPastes }}
        <div class="flex flex-col gap-3">
            {{ range .PublicPastes }}
            <a href="/p/{{ .ID }}"
                class="group block bg-[#111] border border-neutral-700 hover:border-neutral-500 rounded p-4 transition-all duration-200">
                <div class="flex justify-between items-start mb-2">
                    <h3 class="text-neutral-200 font-medium text-sm group-hover:text-white truncate pr-4">
                        {{ if .Title }}{{ .Title }}{{ else }}Untitled Paste{{ end }}
                    </h3>
                    <span
                        class="text-[10px] font-mono text-neutral-500 bg-neutral-900 border border-neutral-700 rounded px-1.5 py-0.5">
                        {{ .ID }}
                    </span>
                </div>

                <div class="flex items-center justify-between mt-3 text-xs text-neutral-500 font-mono">
                    <div class="flex items-center gap-3">
                        <span class="flex items-center gap-1.5">
                            <img src="/static/icons/eye.png" alt="views" class="w-3 h-3 opacity-60 invert">
                            {{ .Views }}
                        </span>
                        <span>{{ .TimeAgo }}</span>
                    </div>

                    <div class="flex gap-2">
                        {{ if .IsPasswordProtected }}
                        <img src="/static/icons/lock.png" alt="Locked" class="w-3 h-3 opacity-60 invert"
                            title="Password Protected">
                        {{ end }}
                        {{ if .BurnAfterReading }}
                        <img src="/static/icons/fire.png" alt="Burn" class="w-3 h-3 opacity-80 invert"
                            title="Burn on Read">
                        {{ end }}
                    </div>
                </div>
            </a>
            {{ end }}
        </div>
        {{ else }}
        <div class="text-center py-12 border border-dashed border-neutral-700 rounded">
            <p class="text-sm text-neutral-600">No public pastes yet.</p>
        </div>
        {{ end }}

        <div
            class="mt-auto bg-neutral-900/50 border border-neutral-800 rounded p-4 text-xs text-neutral-500 leading-relaxed">
            <strong class="text-neutral-300 block mb-1">Privacy Notice</strong>
            All pastes are encrypted at rest. Unlisted pastes are accessible only via link. Expired pastes are
            permanently wiped from the database.
        </div>
    </div>
</div>

{{ template "footer" . }}
{{ end }}
